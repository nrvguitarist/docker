#============================= Filebeat modules ===============================

filebeat.config.modules:
  # Glob pattern for configuration loading
  path: ${path.config}/modules.d/*.yml

  # Set to true to enable config reloading
  reload.enabled: true

  # Period on which files under path should be checked for changes
  #reload.period: 10s


tags: ["pa_log", "filebeat_panw_v2.0"]


#----------------------------- Redis Output -----------------------------------
output.redis:
  hosts: ["localhost"]
  password: "xyz"
  key: "panw"
  db: 0
  timeout: 5
  datatype: list
  bulk_max_size: 500
  worker: 2
#----------------------------- Queue Tuning -----------------------------------
#
queue.mem:
  events: 2000
  flush.min_events: 500
#  flush.timeout: 5s

#================================ Processors =====================================

# Configure processors to enhance or manipulate events generated by the beat.

processors:
#  - add_host_metadata: ~
#  - add_cloud_metadata: ~
#  - add_docker_metadata: ~
#  - add_kubernetes_metadata: ~
  - drop_fields:
      fields: ["event.timezone"]
      ignore_missing: true


#================================ Logging =====================================

# Sets log level. The default log level is info.
# Available log levels are: error, warning, info, debug
#logging.level: debug
logging.level: info
logging.to_files: true
logging.files:
  path: /var/log/filebeat
  name: filebeat.log
  keepfiles: 7
  permissions: 0644
# At debug level, you can selectively enable logging only for some components.
# To enable all selectors use ["*"]. Examples of other selectors are "beat",
# "publish", "service".
#logging.selectors: ["*"]


#============================== X-Pack Monitoring ===============================
# Set to true to enable the monitoring reporter.
monitoring.enabled: false
http.enabled: true
http.port: 5066

